list_of_common_grams = [('10,', '2,', '358', 'of'), ('2,', '358', 'of', 'the'),
                        ('considering', 'and', 'resolving', 'civil'), ('and', 'resolving', 'civil', 'cases,'),
                        ('is', 'obliged', 'to', 'strictly'), ('obliged', 'to', 'strictly', 'comply'),
                        ('to', 'strictly', 'comply', 'with'), ('strictly', 'comply', 'with', 'the'),
                        ('comply', 'with', 'the', 'requirements'), ('with', 'the', 'requirements', 'of'),
                        ('the', 'requirements', 'of', 'the'), ('requirements', 'of', 'the', 'Constitution'),
                        ('of', 'the', 'Constitution', 'of'), ('the', 'Constitution', 'of', 'the'),
                        ('Constitution', 'of', 'the', 'Republic'), ('of', 'the', 'Republic', 'of'),
                        ('the', 'Republic', 'of', 'Kazakhstan,'), ('Republic', 'of', 'Kazakhstan,', 'constitutional'),
                        ('of', 'the', 'Republic', 'of'), ('the', 'Republic', 'of', 'Kazakhstan,'),
                        ('Republic', 'of', 'Kazakhstan,', 'this'), ('and', 'other', 'regulatory', 'legal'),
                        ('other', 'regulatory', 'legal', 'acts'), ('international', 'treaties', 'of', 'the'),
                        ('treaties', 'of', 'the', 'Republic'), ('of', 'the', 'Republic', 'of'),
                        ('the', 'Republic', 'of', 'Kazakhstan.'), ('2.', 'The', 'courts', 'are'),
                        ('The', 'courts', 'are', 'not'), ('courts', 'are', 'not', 'entitled'),
                        ('are', 'not', 'entitled', 'to'), ('not', 'entitled', 'to', 'apply'),
                        ('entitled', 'to', 'apply', 'laws'), ('to', 'apply', 'laws', 'and'),
                        ('apply', 'laws', 'and', 'other'), ('laws', 'and', 'other', 'regulatory'),
                        ('and', 'other', 'regulatory', 'legal'), ('other', 'regulatory', 'legal', 'acts'),
                        ('regulatory', 'legal', 'acts', 'that'), ('legal', 'acts', 'that', 'infringe'),
                        ('acts', 'that', 'infringe', 'the'), ('that', 'infringe', 'the', 'rights'),
                        ('infringe', 'the', 'rights', 'and'), ('the', 'rights', 'and', 'freedoms'),
                        ('rights', 'and', 'freedoms', 'of'), ('the', 'Constitution.', 'If', 'the'),
                        ('Constitution.', 'If', 'the', 'court'), ('If', 'the', 'court', 'finds'),
                        ('the', 'court', 'finds', 'that'), ('law', 'or', 'other', 'regulatory'),
                        ('or', 'other', 'regulatory', 'legal'), ('other', 'regulatory', 'legal', 'act'),
                        ('regulatory', 'legal', 'act', 'to'), ('legal', 'act', 'to', 'be'),
                        ('act', 'to', 'be', 'applied'), ('to', 'be', 'applied', 'infringes'),
                        ('the', 'rights', 'and', 'freedoms'), ('rights', 'and', 'freedoms', 'of'),
                        ('is', 'obliged', 'to', 'suspend'), ('obliged', 'to', 'suspend', 'the'),
                        ('to', 'suspend', 'the', 'proceedings'), ('and', 'apply', 'to', 'the'),
                        ('apply', 'to', 'the', 'Constitutional'), ('to', 'the', 'Constitutional', 'Council'),
                        ('the', 'Constitutional', 'Council', 'of'), ('Constitutional', 'Council', 'of', 'the'),
                        ('Council', 'of', 'the', 'Republic'), ('of', 'the', 'Republic', 'of'),
                        ('the', 'Republic', 'of', 'Kazakhstan'), ('Republic', 'of', 'Kazakhstan', 'with'),
                        ('of', 'Kazakhstan', 'with', 'a'), ('Kazakhstan', 'with', 'a', 'view'),
                        ('with', 'a', 'view', 'to'), ('act', 'unconstitutional.', 'Upon', 'the'),
                        ('of', 'the', 'final', 'decision'), ('the', 'final', 'decision', 'of'),
                        ('final', 'decision', 'of', 'the'), ('decision', 'of', 'the', 'Constitutional'),
                        ('of', 'the', 'Constitutional', 'Council,'), ('the', 'Constitutional', 'Council,', 'the'),
                        ('Constitutional', 'Council,', 'the', 'proceedings'), ('resumed.', '3.', 'The', 'court,'),
                        ('3.', 'The', 'court,', 'having'), ('The', 'court,', 'having', 'established'),
                        ('act', 'of', 'a', 'state'), ('of', 'a', 'state', 'or'), ('a', 'state', 'or', 'other'),
                        ('state', 'or', 'other', 'body'), ('or', 'other', 'body', 'with'),
                        ('other', 'body', 'with', 'the'), ('body', 'with', 'the', 'law'), ('with', 'the', 'law', 'or'),
                        ('of', 'law', 'governing', 'the'), ('law', 'governing', 'the', 'disputed'),
                        ('governing', 'the', 'disputed', 'legal'), ('the', 'disputed', 'legal', 'relationship,'),
                        ('disputed', 'legal', 'relationship,', 'the'), ('legal', 'relationship,', 'the', 'court'),
                        ('of', 'law', 'governing', 'similar'), ('in', 'the', 'absence', 'of'),
                        ('the', 'absence', 'of', 'such'), ('general', 'principles', 'and', 'meaning'),
                        ('principles', 'and', 'meaning', 'of'), ('and', 'meaning', 'of', 'the'),
                        ('meaning', 'of', 'the', 'legislation'), ('of', 'the', 'legislation', 'of'),
                        ('the', 'legislation', 'of', 'the'), ('legislation', 'of', 'the', 'Republic'),
                        ('of', 'the', 'Republic', 'of'), ('the', 'Republic', 'of', 'Kazakhstan.'),
                        ('Republic', 'of', 'Kazakhstan.', '5.'), ('of', 'Kazakhstan.', '5.', 'If'),
                        ('Kazakhstan.', '5.', 'If', 'the'), ('5.', 'If', 'the', 'law'), ('If', 'the', 'law', 'or'),
                        ('agreement', 'of', 'the', 'parties'), ('of', 'the', 'parties', 'to'),
                        ('the', 'parties', 'to', 'the'), ('parties', 'to', 'the', 'dispute'),
                        ('to', 'the', 'dispute', 'provides'), ('the', 'dispute', 'provides', 'for'),
                        ('dispute', 'provides', 'for', 'the'), ('provides', 'for', 'the', 'resolution'),
                        ('for', 'the', 'resolution', 'of'), ('relevant', 'issues', 'by', 'the'),
                        ('issues', 'by', 'the', 'court,'), ('by', 'the', 'court,', 'the'),
                        ('the', 'court,', 'the', 'court'), ('court,', 'the', 'court', 'is'),
                        ('the', 'court', 'is', 'obliged'), ('court', 'is', 'obliged', 'to'),
                        ('is', 'obliged', 'to', 'resolve'), ('obliged', 'to', 'resolve', 'these'),
                        ('to', 'resolve', 'these', 'issues'), ('the', 'criteria', 'of', 'fairness'),
                        ('criteria', 'of', 'fairness', 'and'), ('of', 'fairness', 'and', 'reasonableness.'),
                        ('fairness', 'and', 'reasonableness.', 'Article'),
                        ('and', 'reasonableness.', 'Article', '176.'), ('property', 'of', 'others', '1.'),
                        ('with', 'a', 'fine', 'in'), ('a', 'fine', 'in', 'the'), ('fine', 'in', 'the', 'amount'),
                        ('in', 'the', 'amount', 'of'), ('two', 'hundred', 'to', 'five'),
                        ('hundred', 'to', 'five', 'hundred'), ('to', 'five', 'hundred', 'monthly'),
                        ('five', 'hundred', 'monthly', 'calculation'), ('hundred', 'monthly', 'calculation', 'indices'),
                        ('monthly', 'calculation', 'indices', 'or'), ('calculation', 'indices', 'or', 'in'),
                        ('indices', 'or', 'in', 'the'), ('or', 'in', 'the', 'amount'), ('in', 'the', 'amount', 'of'),
                        ('the', 'amount', 'of', 'the'), ('amount', 'of', 'the', 'salary'),
                        ('of', 'the', 'salary', 'or'), ('the', 'salary', 'or', 'other'),
                        ('salary', 'or', 'other', 'income'), ('or', 'other', 'income', 'of'),
                        ('other', 'income', 'of', 'the'), ('period', 'of', 'one', 'hundred'),
                        ('twenty', 'to', 'one', 'hundred'), ('up', 'to', 'three', 'years.')]

split_text = ['In', 'accordance', 'with', 'articles', '10,', '2,', '358', 'of', 'the', 'Commercial', 'Code', 'of', '27',
              'October', '2013,', 'the', 'Government', 'makes', 'a', 'RESOLUTION', 'as', 'follows:', 'Article', '6.',
              'Legitimacy', '1.', 'In', 'considering', 'and', 'resolving', 'civil', 'cases,', 'the', 'court', 'is',
              'obliged', 'to', 'strictly', 'comply', 'with', 'the', 'requirements', 'of', 'the', 'Constitution', 'of',
              'the', 'Republic', 'of', 'Kazakhstan,', 'constitutional', 'statutes', 'of', 'the', 'Republic', 'of',
              'Kazakhstan,', 'this', 'Code', 'and', 'other', 'regulatory', 'legal', 'acts', 'and', 'international',
              'treaties', 'of', 'the', 'Republic', 'of', 'Kazakhstan', 'subject', 'to', 'application.', '2.', 'The',
              'courts', 'are', 'not', 'entitled', 'to', 'apply', 'laws', 'and', 'other', 'regulatory', 'legal', 'acts',
              'that', 'infringe', 'the', 'rights', 'and', 'freedoms', 'of', 'an', 'individual', 'and', 'a', 'citizen',
              'established', 'by', 'the', 'Constitution.', 'If', 'the', 'court', 'finds', 'that', 'the', 'law', 'or',
              'other', 'regulatory', 'legal', 'act', 'to', 'be', 'applied', 'infringes', 'the', 'rights', 'and',
              'freedoms', 'of', 'an', 'individual', 'and', 'a', 'citizen', 'established', 'by', 'the', 'Constitution,',
              'it', 'is', 'obliged', 'to', 'suspend', 'the', 'proceedings', 'on', 'the', 'case', 'and', 'apply', 'to',
              'the', 'Constitutional', 'Council', 'of', 'the', 'Republic', 'of', 'Kazakhstan', 'with', 'a', 'view',
              'to', 'deem', 'such', 'act', 'unconstitutional.', 'Upon', 'the', 'receipt', 'by', 'the', 'court', 'of',
              'the', 'final', 'decision', 'of', 'the', 'Constitutional', 'Council,', 'the', 'proceedings', 'on', 'the',
              'case', 'will', 'be', 'resumed.', '3.', 'The', 'court,', 'having', 'established', 'in', 'considering',
              'and', 'resolving', 'the', 'case', 'the', 'non-compliance', 'of', 'the', 'act', 'of', 'a', 'state', 'or',
              'other', 'body', 'with', 'the', 'law', 'or', 'its', 'issuance', 'in', 'excess', 'of', 'powers,', 'will',
              'apply', 'the', 'norms', 'of', 'law.', '4.', 'In', 'case', 'of', 'the', 'absence', 'of', 'the', 'norms',
              'of', 'law', 'governing', 'the', 'disputed', 'legal', 'relationship,', 'the', 'court', 'will', 'apply',
              'the', 'norms', 'of', 'law', 'governing', 'similar', 'relationship', 'or,', 'in', 'the', 'absence', 'of',
              'such', 'norms,', 'will', 'resolve', 'the', 'dispute', 'on', 'the', 'basis', 'of', 'general',
              'principles', 'and', 'meaning', 'of', 'the', 'legislation', 'of', 'the', 'Republic', 'of', 'Kazakhstan.',
              '5.', 'If', 'the', 'law', 'or', 'agreement', 'of', 'the', 'parties', 'to', 'the', 'dispute', 'provides',
              'for', 'the', 'resolution', 'of', 'the', 'relevant', 'issues', 'by', 'the', 'court,', 'the', 'court',
              'is', 'obliged', 'to', 'resolve', 'these', 'issues', 'on', 'the', 'basis', 'of', 'the', 'criteria', 'of',
              'fairness', 'and', 'reasonableness.', 'Article', '176.', 'Misappropriation', 'or', 'embezzlement', 'of',
              'the', 'property', 'of', 'others', '1.', 'Misappropriation,', 'or', 'embezzlement,', 'that', 'is,',
              'theft', 'of', 'the', 'property', 'of', 'another', 'entrusted', 'to', 'the', 'perpetrator,', 'is',
              'punishable', 'with', 'a', 'fine', 'in', 'the', 'amount', 'of', 'two', 'hundred', 'to', 'five', 'hundred',
              'monthly', 'calculation', 'indices', 'or', 'in', 'the', 'amount', 'of', 'the', 'salary', 'or', 'other',
              'income', 'of', 'the', 'convicted', 'person', 'for', 'the', 'period', 'of', 'two', 'to', 'five', 'months',
              'or', 'with', 'the', 'engagement', 'in', 'community', 'service', 'for', 'the', 'period', 'of', 'one',
              'hundred', 'and', 'twenty', 'to', 'one', 'hundred', 'and', 'eighty', 'hours', 'or', 'with',
              'correctional', 'labor', 'for', 'the', 'period', 'of', 'up', 'to', 'two', 'years', 'or', 'with', 'arrest',
              'for', 'the', 'period', 'of', 'up', 'to', 'six', 'months', 'or', 'with', 'imprisonment', 'for', 'the',
              'period', 'of', 'up', 'to', 'three', 'years.']
# from nltk import ngrams

text_split1 = list(split_text)
# text_grams = ngrams(text_split1, 4)
text_with_tags = list(split_text)
start_tag = '<span style="background-color: #85e8c8">'
end_tag = '</span>'
current_pos = 0
# j = 0
for gramm in list_of_common_grams:
    current_pos = 0
    current_fourgramm = \
        (text_split1[current_pos], text_split1[current_pos + 1], text_split1[current_pos + 2],
         text_split1[current_pos + 3])
    while current_fourgramm != gramm and current_pos < len(split_text) - 4:
        current_pos += 1
        current_fourgramm = \
            (text_split1[current_pos], text_split1[current_pos + 1], text_split1[current_pos + 2],
             text_split1[current_pos + 3])
    else:
        text_with_tags[current_pos] = start_tag + text_split1[current_pos] + end_tag
        text_with_tags[current_pos + 1] = start_tag + text_split1[current_pos + 1] + end_tag
        text_with_tags[current_pos + 2] = start_tag + text_split1[current_pos + 2] + end_tag
        text_with_tags[current_pos + 3] = start_tag + text_split1[current_pos + 3] + end_tag

print(text_with_tags)
# for i in range(len(text_split1) - 3):
#     current_fourgramm = \
#         (text_split1[current_pos], text_split1[current_pos + 1], text_split1[current_pos + 2],
#          text_split1[current_pos + 3])
#     if current_fourgramm != list_of_common_grams[j]:
#         current_pos += 1
#     else:
#         text_with_tags[current_pos] = start_tag + text_split1[current_pos] + end_tag
#         text_with_tags[current_pos + 1] = start_tag + text_split1[current_pos + 1] + end_tag
#         text_with_tags[current_pos + 2] = start_tag + text_split1[current_pos + 2] + end_tag
#         text_with_tags[current_pos + 3] = start_tag + text_split1[current_pos + 3] + end_tag
#         current_pos += 1
#         if j == len(list_of_common_grams) - 1:
#             break
#         j += 1
# print(text_with_tags)
